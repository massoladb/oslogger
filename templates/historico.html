{% extends "base.html" %}
{% block content %}
<h2>Histórico de Ordens de Serviço</h2>

<form method="GET" action="{{ url_for('historico') }}" class="form-horizontal" style="margin-bottom: 20px;">
  
  <div class="form-group">
    <label for="data">Filtrar por data:</label>
    <input type="date" id="data" name="data" value="{{ filtro_data }}">
  </div>
  
  <div class="form-group-button">
    <button type="submit" class="btn btn-primary">Filtrar</button>
    <a href="{{ url_for('historico') }}" class="btn btn-secondary">Ver todas</a>
  </div>
</form>

<table>
  <thead>
    <tr>
      <th>Data</th>
      <th>Hora</th>
      <th>Número OS</th>
      <th>Cliente</th>
      <th>Vendedor</th>
      <th>Status</th>
      <th>Observação</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
  {% for os in registros %}
    <tr>
      <td>{{ os.data_hora_registro.strftime('%d/%m/%Y') }}</td>
      <td>{{ os.data_hora_registro.strftime('%H:%M') }}</td>
      <td>{{ os.numero_os }}</td>
      <td>{{ os.cliente }}</td>
      <td>{{ os.vendedor }}</td>
      <td>{{ os.status.value }}</td>
      <td>{{ os.observacao or '' }}</td>
      <td>
        <a href="{{ url_for('editar', id=os.id) }}" class="btn-link">Editar</a>
        <form action="{{ url_for('remover_os', os_id=os.id) }}" method="POST" style="display:inline;">
          <button type="submit" class="btn-link-destructive" onclick="return confirm('Tem certeza que deseja remover esta OS?')">Remover</button>
        </form>
      </td>
    </tr>
  {% else %}
    <tr><td colspan="8">Nenhuma ordem encontrada.</td></tr>
  {% endfor %}
  </tbody>
</table>

{% endblock %}